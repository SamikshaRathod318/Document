<div class="department-container">
  <div class="header">
    <h1>Departments</h1>
    <div class="search-container">
      <div class="search-box">
        <span class="search-icon">🔍</span>
        <input type="text" placeholder="Search departments..." [(ngModel)]="searchQuery" (input)="filterCategories()">
      </div>
      <button class="new-dept-btn" (click)="createNewCategory()">
        <span>+</span>
        New Department
      </button>
    </div>
  </div>
  
  <div class="departments-grid">
    <div class="department-card" *ngFor="let category of filteredCategories">
      <div class="card-header">
        <h2 class="department-name">{{ category.name }}</h2>
        <span class="document-count">{{ category.documentCount }} documents</span>
      </div>
      
      <p class="department-description">{{ category.description || 'No description provided' }}</p>
      
      <div class="card-footer">
        <span class="last-updated">Updated {{ category.lastUpdated | date:'MMM d, y' }}</span>
        <div class="card-actions">
          <button class="action-btn edit-btn" (click)="editCategory(category, $event)" title="Edit">
            📝
          </button>
          <button class="action-btn delete-btn" (click)="openDelete(category, $event)" title="Delete">
            🗑️
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Create Department Modal -->
  <div class="modal-backdrop" *ngIf="isCreateOpen" (click)="closeCreate()"></div>
  <div class="modal" *ngIf="isCreateOpen">
    <div class="modal-header">
      <h2>New Department</h2>
      <button type="button" class="close-btn" (click)="closeCreate()">×</button>
    </div>
    <div class="modal-body">
      <label>
        <span>Name</span>
        <input type="text" [(ngModel)]="createForm.name" placeholder="Department name" />
      </label>
      <label>
        <span>Description</span>
        <textarea [(ngModel)]="createForm.description" rows="3" placeholder="Short description"></textarea>
      </label>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn" (click)="closeCreate()">Cancel</button>
      <button type="button" class="btn primary" (click)="saveCreate()">Save</button>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal-backdrop" *ngIf="isDeleteOpen" (click)="closeDelete()"></div>
  <div class="modal" *ngIf="isDeleteOpen">
    <div class="modal-header">
      <h2>Delete Department</h2>
      <button type="button" class="close-btn" (click)="closeDelete()">×</button>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to delete <strong>{{ deleteTarget?.name }}</strong>? This action cannot be undone.</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn" (click)="closeDelete()">Cancel</button>
      <button type="button" class="btn danger" (click)="confirmDelete()">Delete</button>
    </div>
  </div>

  <!-- Edit Department Modal -->
  <div class="modal-backdrop" *ngIf="isEditOpen" (click)="closeEdit()"></div>
  <div class="modal" *ngIf="isEditOpen">
    <div class="modal-header">
      <h2>Edit Department</h2>
      <button type="button" class="close-btn" (click)="closeEdit()">×</button>
    </div>
    <div class="modal-body">
      <label>
        <span>Name</span>
        <input type="text" [(ngModel)]="editForm.name" placeholder="Department name" />
      </label>
      <label>
        <span>Description</span>
        <textarea [(ngModel)]="editForm.description" rows="3" placeholder="Short description"></textarea>
      </label>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn" (click)="closeEdit()">Cancel</button>
      <button type="button" class="btn primary" (click)="saveEdit()">Save</button>
    </div>
  </div>
</div>